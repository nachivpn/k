<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>IS4.Term.Base</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--safe</a> <a id="20" class="Pragma">--without-K</a> <a id="32" class="Symbol">#-}</a>
<a id="36" class="Keyword">module</a> <a id="43" href="IS4.Term.Base.html" class="Module">IS4.Term.Base</a> <a id="57" class="Keyword">where</a>

<a id="64" class="Comment">--</a>
<a id="67" class="Comment">-- Implementation of the IS4 (Intuitionistic S4) calculus from</a>
<a id="130" class="Comment">-- &quot;Fitch-Style Modal Lambda Calculi&quot; by Ranald Clouston (2018)</a>
<a id="194" class="Comment">--</a>

<a id="198" class="Keyword">open</a> <a id="203" class="Keyword">import</a> <a id="210" href="Data.Product.html" class="Module">Data.Product</a> <a id="223" class="Keyword">using</a> <a id="229" class="Symbol">(</a><a id="230" href="Data.Product.html#1369" class="Function">∃</a> <a id="232" class="Symbol">;</a> <a id="234" href="Data.Product.html#1167" class="Function Operator">_×_</a> <a id="238" class="Symbol">;</a> <a id="240" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a> <a id="244" class="Symbol">;</a> <a id="246" href="Data.Product.html#2247" class="Function Operator">-,_</a> <a id="250" class="Symbol">;</a> <a id="252" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="258" class="Symbol">;</a> <a id="260" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a><a id="265" class="Symbol">)</a>

<a id="268" class="Keyword">open</a> <a id="273" class="Keyword">import</a> <a id="280" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="318" class="Keyword">using</a> <a id="324" class="Symbol">(</a><a id="325" href="Relation.Binary.PropositionalEquality.Core.html#1684" class="Function">sym</a> <a id="329" class="Symbol">;</a> <a id="331" href="Relation.Binary.PropositionalEquality.Core.html#1780" class="Function">subst</a><a id="336" class="Symbol">)</a>

<a id="339" class="Keyword">open</a> <a id="344" class="Keyword">import</a> <a id="351" href="Type.html" class="Module">Type</a> <a id="356" class="Symbol">as</a> <a id="359" class="Module">Type</a> <a id="364" class="Keyword">using</a> <a id="370" class="Symbol">(</a><a id="371" href="Type.Base.html#79" class="Datatype">Ty</a> <a id="374" class="Symbol">;</a> <a id="376" href="Type.Properties.html#299" class="Function">Ty-Decidable</a><a id="388" class="Symbol">)</a>

<a id="391" class="Keyword">import</a> <a id="398" href="Context.html" class="Module">Context</a> <a id="406" href="Type.Base.html#79" class="Datatype">Ty</a> <a id="409" href="Type.Properties.html#299" class="Function">Ty-Decidable</a> as <a id="Context"></a><a id="425" href="IS4.Term.Base.html#425" class="Module">Context</a>

<a id="434" class="Keyword">open</a> <a id="439" href="IS4.Term.Base.html#425" class="Module">Context</a> <a id="447" class="Keyword">public</a> <a id="454" class="Keyword">hiding</a> <a id="461" class="Symbol">(</a><a id="462" href="Context.Base.html#4116" class="InductiveConstructor">ext#</a><a id="466" class="Symbol">)</a>
<a id="468" class="Keyword">open</a> <a id="473" href="Type.html" class="Module">Type</a>    <a id="481" class="Keyword">public</a>

<a id="489" class="Comment">-------------------------------------</a>
<a id="527" class="Comment">-- Variables, terms and substitutions</a>
<a id="565" class="Comment">-------------------------------------</a>

<a id="604" class="Keyword">data</a> <a id="Tm"></a><a id="609" href="IS4.Term.Base.html#609" class="Datatype">Tm</a> <a id="612" class="Symbol">:</a> <a id="614" href="Context.Base.html#419" class="Datatype">Ctx</a> <a id="618" class="Symbol">→</a> <a id="620" href="Type.Base.html#79" class="Datatype">Ty</a> <a id="623" class="Symbol">→</a> <a id="625" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="629" class="Keyword">where</a>

  <a id="Tm.var"></a><a id="638" href="IS4.Term.Base.html#638" class="InductiveConstructor">var</a>  <a id="643" class="Symbol">:</a> <a id="645" class="Symbol">(</a><a id="646" href="IS4.Term.Base.html#646" class="Bound">v</a> <a id="648" class="Symbol">:</a> <a id="650" href="Context.Base.html#2565" class="Datatype">Var</a> <a id="654" href="Context.Base.html#598" class="Generalizable">Γ</a> <a id="656" href="Type.Base.html#172" class="Generalizable">a</a><a id="657" class="Symbol">)</a>
       <a id="666" class="Comment">---------------</a>
       <a id="689" class="Symbol">→</a> <a id="691" href="IS4.Term.Base.html#609" class="Datatype">Tm</a> <a id="694" href="Context.Base.html#598" class="Generalizable">Γ</a> <a id="696" href="Type.Base.html#172" class="Generalizable">a</a>

  <a id="Tm.lam"></a><a id="701" href="IS4.Term.Base.html#701" class="InductiveConstructor">lam</a>  <a id="706" class="Symbol">:</a> <a id="708" class="Symbol">(</a><a id="709" href="IS4.Term.Base.html#709" class="Bound">t</a> <a id="711" class="Symbol">:</a> <a id="713" href="IS4.Term.Base.html#609" class="Datatype">Tm</a> <a id="716" class="Symbol">(</a><a id="717" href="Context.Base.html#598" class="Generalizable">Γ</a> <a id="719" href="Context.Base.html#450" class="InductiveConstructor Operator">`,</a> <a id="722" href="Type.Base.html#172" class="Generalizable">a</a><a id="723" class="Symbol">)</a> <a id="725" href="Type.Base.html#174" class="Generalizable">b</a><a id="726" class="Symbol">)</a>
         <a id="737" class="Comment">-------------------</a>
       <a id="764" class="Symbol">→</a> <a id="766" href="IS4.Term.Base.html#609" class="Datatype">Tm</a> <a id="769" href="Context.Base.html#598" class="Generalizable">Γ</a> <a id="771" class="Symbol">(</a><a id="772" href="Type.Base.html#172" class="Generalizable">a</a> <a id="774" href="Type.Base.html#107" class="InductiveConstructor Operator">⇒</a> <a id="776" href="Type.Base.html#174" class="Generalizable">b</a><a id="777" class="Symbol">)</a>

  <a id="Tm.app"></a><a id="782" href="IS4.Term.Base.html#782" class="InductiveConstructor">app</a>  <a id="787" class="Symbol">:</a> <a id="789" class="Symbol">(</a><a id="790" href="IS4.Term.Base.html#790" class="Bound">t</a> <a id="792" class="Symbol">:</a> <a id="794" href="IS4.Term.Base.html#609" class="Datatype">Tm</a> <a id="797" href="Context.Base.html#598" class="Generalizable">Γ</a> <a id="799" class="Symbol">(</a><a id="800" href="Type.Base.html#172" class="Generalizable">a</a> <a id="802" href="Type.Base.html#107" class="InductiveConstructor Operator">⇒</a> <a id="804" href="Type.Base.html#174" class="Generalizable">b</a><a id="805" class="Symbol">))</a>
       <a id="815" class="Symbol">→</a> <a id="817" class="Symbol">(</a><a id="818" href="IS4.Term.Base.html#818" class="Bound">u</a> <a id="820" class="Symbol">:</a> <a id="822" href="IS4.Term.Base.html#609" class="Datatype">Tm</a> <a id="825" href="Context.Base.html#598" class="Generalizable">Γ</a> <a id="827" href="Type.Base.html#172" class="Generalizable">a</a><a id="828" class="Symbol">)</a>
         <a id="839" class="Comment">------------------</a>
       <a id="865" class="Symbol">→</a> <a id="867" href="IS4.Term.Base.html#609" class="Datatype">Tm</a> <a id="870" href="Context.Base.html#598" class="Generalizable">Γ</a> <a id="872" href="Type.Base.html#174" class="Generalizable">b</a>

  <a id="Tm.box"></a><a id="877" href="IS4.Term.Base.html#877" class="InductiveConstructor">box</a>   <a id="883" class="Symbol">:</a> <a id="885" class="Symbol">(</a><a id="886" href="IS4.Term.Base.html#886" class="Bound">t</a> <a id="888" class="Symbol">:</a> <a id="890" href="IS4.Term.Base.html#609" class="Datatype">Tm</a> <a id="893" class="Symbol">(</a><a id="894" href="Context.Base.html#598" class="Generalizable">Γ</a> <a id="896" href="Context.Base.html#486" class="InductiveConstructor Operator">#</a><a id="897" class="Symbol">)</a> <a id="899" href="Type.Base.html#172" class="Generalizable">a</a><a id="900" class="Symbol">)</a>
        <a id="910" class="Comment">------------------</a>
        <a id="937" class="Symbol">→</a> <a id="939" href="IS4.Term.Base.html#609" class="Datatype">Tm</a> <a id="942" href="Context.Base.html#598" class="Generalizable">Γ</a> <a id="944" class="Symbol">(</a><a id="945" href="Type.Base.html#140" class="InductiveConstructor Operator">□</a> <a id="947" href="Type.Base.html#172" class="Generalizable">a</a><a id="948" class="Symbol">)</a>

  <a id="Tm.unbox"></a><a id="953" href="IS4.Term.Base.html#953" class="InductiveConstructor">unbox</a> <a id="959" class="Symbol">:</a> <a id="961" class="Symbol">(</a><a id="962" href="IS4.Term.Base.html#962" class="Bound">t</a> <a id="964" class="Symbol">:</a> <a id="966" href="IS4.Term.Base.html#609" class="Datatype">Tm</a> <a id="969" href="Context.Base.html#607" class="Generalizable">ΓL</a> <a id="972" class="Symbol">(</a><a id="973" href="Type.Base.html#140" class="InductiveConstructor Operator">□</a> <a id="975" href="Type.Base.html#172" class="Generalizable">a</a><a id="976" class="Symbol">))</a>
        <a id="987" class="Symbol">→</a> <a id="989" class="Symbol">(</a><a id="990" href="IS4.Term.Base.html#990" class="Bound">e</a> <a id="992" class="Symbol">:</a> <a id="994" href="Context.Base.html#5052" class="Function">CExt</a> <a id="999" href="Context.Base.html#598" class="Generalizable">Γ</a> <a id="1001" href="Context.Base.html#607" class="Generalizable">ΓL</a> <a id="1004" href="Context.Base.html#627" class="Generalizable">ΓR</a><a id="1006" class="Symbol">)</a>
        <a id="1016" class="Comment">--------------------</a>
        <a id="1045" class="Symbol">→</a> <a id="1047" href="IS4.Term.Base.html#609" class="Datatype">Tm</a> <a id="1050" href="Context.Base.html#598" class="Generalizable">Γ</a> <a id="1052" href="Type.Base.html#172" class="Generalizable">a</a>

<a id="1055" class="Keyword">variable</a>
  <a id="1066" href="IS4.Term.Base.html#1066" class="Generalizable">t</a> <a id="1068" href="IS4.Term.Base.html#1068" class="Generalizable">t&#39;</a> <a id="1071" href="IS4.Term.Base.html#1071" class="Generalizable">t&#39;&#39;</a> <a id="1075" href="IS4.Term.Base.html#1075" class="Generalizable">t&#39;&#39;&#39;</a> <a id="1080" class="Symbol">:</a> <a id="1082" href="IS4.Term.Base.html#609" class="Datatype">Tm</a> <a id="1085" href="Context.Base.html#598" class="Generalizable">Γ</a> <a id="1087" href="Type.Base.html#172" class="Generalizable">a</a>
  <a id="1091" href="IS4.Term.Base.html#1091" class="Generalizable">u</a> <a id="1093" href="IS4.Term.Base.html#1093" class="Generalizable">u&#39;</a> <a id="1096" href="IS4.Term.Base.html#1096" class="Generalizable">u&#39;&#39;</a> <a id="1100" href="IS4.Term.Base.html#1100" class="Generalizable">u&#39;&#39;&#39;</a> <a id="1105" class="Symbol">:</a> <a id="1107" href="IS4.Term.Base.html#609" class="Datatype">Tm</a> <a id="1110" href="Context.Base.html#598" class="Generalizable">Γ</a> <a id="1112" href="Type.Base.html#172" class="Generalizable">a</a>

<a id="1115" class="Keyword">pattern</a> <a id="var0"></a><a id="1123" href="IS4.Term.Base.html#1123" class="InductiveConstructor">var0</a> <a id="1128" class="Symbol">=</a> <a id="1130" href="IS4.Term.Base.html#638" class="InductiveConstructor">var</a> <a id="1134" href="Context.Base.html#2665" class="InductiveConstructor">v0</a>
<a id="1137" class="Keyword">pattern</a> <a id="var1"></a><a id="1145" href="IS4.Term.Base.html#1145" class="InductiveConstructor">var1</a> <a id="1150" class="Symbol">=</a> <a id="1152" href="IS4.Term.Base.html#638" class="InductiveConstructor">var</a> <a id="1156" href="Context.Base.html#2683" class="InductiveConstructor">v1</a>
<a id="1159" class="Keyword">pattern</a> <a id="var2"></a><a id="1167" href="IS4.Term.Base.html#1167" class="InductiveConstructor">var2</a> <a id="1172" class="Symbol">=</a> <a id="1174" href="IS4.Term.Base.html#638" class="InductiveConstructor">var</a> <a id="1178" href="Context.Base.html#2704" class="InductiveConstructor">v2</a>

<a id="wkTm"></a><a id="1182" href="IS4.Term.Base.html#1182" class="Function">wkTm</a> <a id="1187" class="Symbol">:</a> <a id="1189" href="Context.Base.html#598" class="Generalizable">Γ</a> <a id="1191" href="Context.Base.html#1356" class="Datatype Operator">⊆</a> <a id="1193" href="Context.Base.html#600" class="Generalizable">Γ&#39;</a> <a id="1196" class="Symbol">→</a> <a id="1198" href="IS4.Term.Base.html#609" class="Datatype">Tm</a> <a id="1201" href="Context.Base.html#598" class="Generalizable">Γ</a> <a id="1203" href="Type.Base.html#172" class="Generalizable">a</a> <a id="1205" class="Symbol">→</a> <a id="1207" href="IS4.Term.Base.html#609" class="Datatype">Tm</a> <a id="1210" href="Context.Base.html#600" class="Generalizable">Γ&#39;</a> <a id="1213" href="Type.Base.html#172" class="Generalizable">a</a>
<a id="1215" href="IS4.Term.Base.html#1182" class="Function">wkTm</a> <a id="1220" href="IS4.Term.Base.html#1220" class="Bound">w</a> <a id="1222" class="Symbol">(</a><a id="1223" href="IS4.Term.Base.html#638" class="InductiveConstructor">var</a> <a id="1227" href="IS4.Term.Base.html#1227" class="Bound">x</a><a id="1228" class="Symbol">)</a>     <a id="1234" class="Symbol">=</a> <a id="1236" href="IS4.Term.Base.html#638" class="InductiveConstructor">var</a> <a id="1240" class="Symbol">(</a><a id="1241" href="Context.Base.html#2718" class="Function">wkVar</a> <a id="1247" href="IS4.Term.Base.html#1220" class="Bound">w</a> <a id="1249" href="IS4.Term.Base.html#1227" class="Bound">x</a><a id="1250" class="Symbol">)</a>
<a id="1252" href="IS4.Term.Base.html#1182" class="Function">wkTm</a> <a id="1257" href="IS4.Term.Base.html#1257" class="Bound">w</a> <a id="1259" class="Symbol">(</a><a id="1260" href="IS4.Term.Base.html#701" class="InductiveConstructor">lam</a> <a id="1264" href="IS4.Term.Base.html#1264" class="Bound">t</a><a id="1265" class="Symbol">)</a>     <a id="1271" class="Symbol">=</a> <a id="1273" href="IS4.Term.Base.html#701" class="InductiveConstructor">lam</a> <a id="1277" class="Symbol">(</a><a id="1278" href="IS4.Term.Base.html#1182" class="Function">wkTm</a> <a id="1283" class="Symbol">(</a><a id="1284" href="Context.Base.html#1442" class="InductiveConstructor">keep</a> <a id="1289" href="IS4.Term.Base.html#1257" class="Bound">w</a><a id="1290" class="Symbol">)</a> <a id="1292" href="IS4.Term.Base.html#1264" class="Bound">t</a><a id="1293" class="Symbol">)</a>
<a id="1295" href="IS4.Term.Base.html#1182" class="Function">wkTm</a> <a id="1300" href="IS4.Term.Base.html#1300" class="Bound">w</a> <a id="1302" class="Symbol">(</a><a id="1303" href="IS4.Term.Base.html#782" class="InductiveConstructor">app</a> <a id="1307" href="IS4.Term.Base.html#1307" class="Bound">t</a> <a id="1309" href="IS4.Term.Base.html#1309" class="Bound">u</a><a id="1310" class="Symbol">)</a>   <a id="1314" class="Symbol">=</a> <a id="1316" href="IS4.Term.Base.html#782" class="InductiveConstructor">app</a> <a id="1320" class="Symbol">(</a><a id="1321" href="IS4.Term.Base.html#1182" class="Function">wkTm</a> <a id="1326" href="IS4.Term.Base.html#1300" class="Bound">w</a> <a id="1328" href="IS4.Term.Base.html#1307" class="Bound">t</a><a id="1329" class="Symbol">)</a> <a id="1331" class="Symbol">(</a><a id="1332" href="IS4.Term.Base.html#1182" class="Function">wkTm</a> <a id="1337" href="IS4.Term.Base.html#1300" class="Bound">w</a> <a id="1339" href="IS4.Term.Base.html#1309" class="Bound">u</a><a id="1340" class="Symbol">)</a>
<a id="1342" href="IS4.Term.Base.html#1182" class="Function">wkTm</a> <a id="1347" href="IS4.Term.Base.html#1347" class="Bound">w</a> <a id="1349" class="Symbol">(</a><a id="1350" href="IS4.Term.Base.html#877" class="InductiveConstructor">box</a> <a id="1354" href="IS4.Term.Base.html#1354" class="Bound">t</a><a id="1355" class="Symbol">)</a>     <a id="1361" class="Symbol">=</a> <a id="1363" href="IS4.Term.Base.html#877" class="InductiveConstructor">box</a> <a id="1367" class="Symbol">(</a><a id="1368" href="IS4.Term.Base.html#1182" class="Function">wkTm</a> <a id="1373" class="Symbol">(</a><a id="1374" href="Context.Base.html#1483" class="InductiveConstructor">keep#</a> <a id="1380" href="IS4.Term.Base.html#1347" class="Bound">w</a><a id="1381" class="Symbol">)</a> <a id="1383" href="IS4.Term.Base.html#1354" class="Bound">t</a><a id="1384" class="Symbol">)</a>
<a id="1386" href="IS4.Term.Base.html#1182" class="Function">wkTm</a> <a id="1391" href="IS4.Term.Base.html#1391" class="Bound">w</a> <a id="1393" class="Symbol">(</a><a id="1394" href="IS4.Term.Base.html#953" class="InductiveConstructor">unbox</a> <a id="1400" href="IS4.Term.Base.html#1400" class="Bound">t</a> <a id="1402" href="IS4.Term.Base.html#1402" class="Bound">e</a><a id="1403" class="Symbol">)</a> <a id="1405" class="Symbol">=</a> <a id="1407" href="IS4.Term.Base.html#953" class="InductiveConstructor">unbox</a> <a id="1413" class="Symbol">(</a><a id="1414" href="IS4.Term.Base.html#1182" class="Function">wkTm</a> <a id="1419" class="Symbol">(</a><a id="1420" href="Context.Base.html#8950" class="Function">factorWk</a> <a id="1429" href="IS4.Term.Base.html#1402" class="Bound">e</a> <a id="1431" href="IS4.Term.Base.html#1391" class="Bound">w</a><a id="1432" class="Symbol">)</a> <a id="1434" href="IS4.Term.Base.html#1400" class="Bound">t</a><a id="1435" class="Symbol">)</a> <a id="1437" class="Symbol">(</a><a id="1438" href="Context.Base.html#9819" class="Function">factorExt</a> <a id="1448" href="IS4.Term.Base.html#1402" class="Bound">e</a> <a id="1450" href="IS4.Term.Base.html#1391" class="Bound">w</a><a id="1451" class="Symbol">)</a>

<a id="1454" class="Comment">-- extension that &quot;generates a new context frame&quot;</a>
<a id="new"></a><a id="1504" href="IS4.Term.Base.html#1504" class="Function">new</a> <a id="1508" class="Symbol">:</a> <a id="1510" href="Context.Base.html#5052" class="Function">CExt</a> <a id="1515" class="Symbol">(</a><a id="1516" href="Context.Base.html#598" class="Generalizable">Γ</a> <a id="1518" href="Context.Base.html#486" class="InductiveConstructor Operator">#</a><a id="1519" class="Symbol">)</a> <a id="1521" href="Context.Base.html#598" class="Generalizable">Γ</a> <a id="1523" class="Symbol">(</a><a id="1524" href="Context.Base.html#437" class="InductiveConstructor">[]</a> <a id="1527" href="Context.Base.html#486" class="InductiveConstructor Operator">#</a><a id="1528" class="Symbol">)</a> <a id="1530" class="Comment">-- Γ R Γ #</a>
<a id="1541" href="IS4.Term.Base.html#1504" class="Function">new</a> <a id="1545" class="Symbol">=</a> <a id="1547" href="Context.Base.html#4253" class="InductiveConstructor">ext#-</a> <a id="1553" href="Context.Base.html#4035" class="InductiveConstructor">nil</a>

<a id="new[_]"></a><a id="1558" href="IS4.Term.Base.html#1558" class="Function Operator">new[_]</a> <a id="1565" class="Symbol">=</a> <a id="1567" class="Symbol">λ</a> <a id="1569" href="IS4.Term.Base.html#1569" class="Bound">Γ</a> <a id="1571" class="Symbol">→</a> <a id="1573" href="IS4.Term.Base.html#1504" class="Function">new</a> <a id="1577" class="Symbol">{</a><a id="1578" href="IS4.Term.Base.html#1569" class="Bound">Γ</a><a id="1579" class="Symbol">}</a>

<a id="1582" class="Keyword">open</a> <a id="1587" href="Context.Base.html#10463" class="Module">Substitution</a> <a id="1600" href="IS4.Term.Base.html#609" class="Datatype">Tm</a> <a id="1603" href="IS4.Term.Base.html#638" class="InductiveConstructor">var</a> <a id="1607" href="IS4.Term.Base.html#1182" class="Function">wkTm</a> <a id="1612" href="Context.Base.html#5052" class="Function">CExt</a> <a id="1617" href="IS4.Term.Base.html#1504" class="Function">new</a> <a id="1621" href="Context.Base.html#8521" class="Function">lCtx</a> <a id="1626" href="Context.Base.html#8950" class="Function">factorWk</a> <a id="1635" href="Context.Base.html#9355" class="Function">rCtx</a> <a id="1640" href="Context.Base.html#9819" class="Function">factorExt</a> <a id="1650" class="Keyword">public</a>
  <a id="1659" class="Keyword">renaming</a> <a id="1668" class="Symbol">(</a><a id="1669" class="Keyword">module</a> <a id="1676" href="Context.Base.html#12850" class="Module">Composition</a> <a id="1688" class="Symbol">to</a> <a id="1691" class="Module">SubstitutionComposition</a><a id="1714" class="Symbol">)</a>

<a id="1717" class="Comment">-- &quot;Left&quot; context of factoring with a substitution (see factorSubₛ and factorExtₛ)</a>
<a id="lCtxₛ"></a><a id="1800" href="IS4.Term.Base.html#1800" class="Function">lCtxₛ</a> <a id="1806" class="Symbol">:</a> <a id="1808" class="Symbol">(</a><a id="1809" href="IS4.Term.Base.html#1809" class="Bound">e</a> <a id="1811" class="Symbol">:</a> <a id="1813" href="Context.Base.html#5052" class="Function">CExt</a> <a id="1818" href="Context.Base.html#598" class="Generalizable">Γ</a> <a id="1820" href="Context.Base.html#607" class="Generalizable">ΓL</a> <a id="1823" href="Context.Base.html#627" class="Generalizable">ΓR</a><a id="1825" class="Symbol">)</a> <a id="1827" class="Symbol">(</a><a id="1828" href="IS4.Term.Base.html#1828" class="Bound">s</a> <a id="1830" class="Symbol">:</a> <a id="1832" href="Context.Base.html#11143" class="Datatype">Sub</a> <a id="1836" href="Context.Base.html#655" class="Generalizable">Δ</a> <a id="1838" href="Context.Base.html#598" class="Generalizable">Γ</a><a id="1839" class="Symbol">)</a> <a id="1841" class="Symbol">→</a> <a id="1843" href="Context.Base.html#419" class="Datatype">Ctx</a>
<a id="1847" href="IS4.Term.Base.html#1800" class="Function">lCtxₛ</a> <a id="1853" class="Symbol">{</a><a id="1854" class="Argument">Δ</a> <a id="1856" class="Symbol">=</a> <a id="1858" href="IS4.Term.Base.html#1858" class="Bound">Δ</a><a id="1859" class="Symbol">}</a> <a id="1861" href="Context.Base.html#4035" class="InductiveConstructor">nil</a>       <a id="1871" href="IS4.Term.Base.html#1871" class="Bound">s</a>           <a id="1883" class="Symbol">=</a> <a id="1885" href="IS4.Term.Base.html#1858" class="Bound">Δ</a>
<a id="1887" href="IS4.Term.Base.html#1800" class="Function">lCtxₛ</a>         <a id="1901" class="Symbol">(</a><a id="1902" href="Context.Base.html#4057" class="InductiveConstructor">ext</a> <a id="1906" href="IS4.Term.Base.html#1906" class="Bound">e</a><a id="1907" class="Symbol">)</a>   <a id="1911" class="Symbol">(</a><a id="1912" href="IS4.Term.Base.html#1912" class="Bound">s</a> <a id="1914" href="Context.Base.html#11195" class="InductiveConstructor Operator">`,</a> <a id="1917" href="IS4.Term.Base.html#1917" class="Bound">t</a><a id="1918" class="Symbol">)</a>    <a id="1923" class="Symbol">=</a> <a id="1925" href="IS4.Term.Base.html#1800" class="Function">lCtxₛ</a> <a id="1931" href="IS4.Term.Base.html#1906" class="Bound">e</a> <a id="1933" href="IS4.Term.Base.html#1912" class="Bound">s</a>
<a id="1935" href="IS4.Term.Base.html#1800" class="Function">lCtxₛ</a>         <a id="1949" class="Symbol">(</a><a id="1950" href="Context.Base.html#4253" class="InductiveConstructor">ext#-</a> <a id="1956" href="IS4.Term.Base.html#1956" class="Bound">e</a><a id="1957" class="Symbol">)</a> <a id="1959" class="Symbol">(</a><a id="1960" href="Context.Base.html#11258" class="InductiveConstructor">lock</a> <a id="1965" href="IS4.Term.Base.html#1965" class="Bound">s</a> <a id="1967" href="IS4.Term.Base.html#1967" class="Bound">e&#39;</a><a id="1969" class="Symbol">)</a> <a id="1971" class="Symbol">=</a> <a id="1973" href="IS4.Term.Base.html#1800" class="Function">lCtxₛ</a> <a id="1979" href="IS4.Term.Base.html#1956" class="Bound">e</a> <a id="1981" href="IS4.Term.Base.html#1965" class="Bound">s</a>

<a id="factorSubₛ"></a><a id="1984" href="IS4.Term.Base.html#1984" class="Function">factorSubₛ</a> <a id="1995" class="Symbol">:</a> <a id="1997" class="Symbol">(</a><a id="1998" href="IS4.Term.Base.html#1998" class="Bound">e</a> <a id="2000" class="Symbol">:</a> <a id="2002" href="Context.Base.html#5052" class="Function">CExt</a> <a id="2007" href="Context.Base.html#598" class="Generalizable">Γ</a> <a id="2009" href="Context.Base.html#607" class="Generalizable">ΓL</a> <a id="2012" href="Context.Base.html#627" class="Generalizable">ΓR</a><a id="2014" class="Symbol">)</a> <a id="2016" class="Symbol">(</a><a id="2017" href="IS4.Term.Base.html#2017" class="Bound">s</a> <a id="2019" class="Symbol">:</a> <a id="2021" href="Context.Base.html#11143" class="Datatype">Sub</a> <a id="2025" href="Context.Base.html#655" class="Generalizable">Δ</a> <a id="2027" href="Context.Base.html#598" class="Generalizable">Γ</a><a id="2028" class="Symbol">)</a> <a id="2030" class="Symbol">→</a> <a id="2032" href="Context.Base.html#11143" class="Datatype">Sub</a> <a id="2036" class="Symbol">(</a><a id="2037" href="IS4.Term.Base.html#1800" class="Function">lCtxₛ</a> <a id="2043" href="IS4.Term.Base.html#1998" class="Bound">e</a> <a id="2045" href="IS4.Term.Base.html#2017" class="Bound">s</a><a id="2046" class="Symbol">)</a> <a id="2048" href="Context.Base.html#607" class="Generalizable">ΓL</a>
<a id="2051" href="IS4.Term.Base.html#1984" class="Function">factorSubₛ</a> <a id="2062" href="Context.Base.html#4035" class="InductiveConstructor">nil</a>       <a id="2072" href="IS4.Term.Base.html#2072" class="Bound">s</a>           <a id="2084" class="Symbol">=</a> <a id="2086" href="IS4.Term.Base.html#2072" class="Bound">s</a>
<a id="2088" href="IS4.Term.Base.html#1984" class="Function">factorSubₛ</a> <a id="2099" class="Symbol">(</a><a id="2100" href="Context.Base.html#4057" class="InductiveConstructor">ext</a> <a id="2104" href="IS4.Term.Base.html#2104" class="Bound">e</a><a id="2105" class="Symbol">)</a>   <a id="2109" class="Symbol">(</a><a id="2110" href="IS4.Term.Base.html#2110" class="Bound">s</a> <a id="2112" href="Context.Base.html#11195" class="InductiveConstructor Operator">`,</a> <a id="2115" href="IS4.Term.Base.html#2115" class="Bound">t</a><a id="2116" class="Symbol">)</a>    <a id="2121" class="Symbol">=</a> <a id="2123" href="IS4.Term.Base.html#1984" class="Function">factorSubₛ</a> <a id="2134" href="IS4.Term.Base.html#2104" class="Bound">e</a> <a id="2136" href="IS4.Term.Base.html#2110" class="Bound">s</a>
<a id="2138" href="IS4.Term.Base.html#1984" class="Function">factorSubₛ</a> <a id="2149" class="Symbol">(</a><a id="2150" href="Context.Base.html#4253" class="InductiveConstructor">ext#-</a> <a id="2156" href="IS4.Term.Base.html#2156" class="Bound">e</a><a id="2157" class="Symbol">)</a> <a id="2159" class="Symbol">(</a><a id="2160" href="Context.Base.html#11258" class="InductiveConstructor">lock</a> <a id="2165" href="IS4.Term.Base.html#2165" class="Bound">s</a> <a id="2167" href="IS4.Term.Base.html#2167" class="Bound">e&#39;</a><a id="2169" class="Symbol">)</a> <a id="2171" class="Symbol">=</a> <a id="2173" href="IS4.Term.Base.html#1984" class="Function">factorSubₛ</a> <a id="2184" href="IS4.Term.Base.html#2156" class="Bound">e</a> <a id="2186" href="IS4.Term.Base.html#2165" class="Bound">s</a>

<a id="2189" class="Comment">-- &quot;Right&quot; context of factoring with a substitution (see factorExtₛ)</a>
<a id="rCtxₛ"></a><a id="2258" href="IS4.Term.Base.html#2258" class="Function">rCtxₛ</a> <a id="2264" class="Symbol">:</a> <a id="2266" class="Symbol">(</a><a id="2267" href="IS4.Term.Base.html#2267" class="Bound">e</a> <a id="2269" class="Symbol">:</a> <a id="2271" href="Context.Base.html#5052" class="Function">CExt</a> <a id="2276" href="Context.Base.html#598" class="Generalizable">Γ</a> <a id="2278" href="Context.Base.html#607" class="Generalizable">ΓL</a> <a id="2281" href="Context.Base.html#627" class="Generalizable">ΓR</a><a id="2283" class="Symbol">)</a> <a id="2285" class="Symbol">(</a><a id="2286" href="IS4.Term.Base.html#2286" class="Bound">s</a> <a id="2288" class="Symbol">:</a> <a id="2290" href="Context.Base.html#11143" class="Datatype">Sub</a> <a id="2294" href="Context.Base.html#655" class="Generalizable">Δ</a> <a id="2296" href="Context.Base.html#598" class="Generalizable">Γ</a><a id="2297" class="Symbol">)</a> <a id="2299" class="Symbol">→</a> <a id="2301" href="Context.Base.html#419" class="Datatype">Ctx</a>
<a id="2305" href="IS4.Term.Base.html#2258" class="Function">rCtxₛ</a> <a id="2311" href="Context.Base.html#4035" class="InductiveConstructor">nil</a>       <a id="2321" href="IS4.Term.Base.html#2321" class="Bound">s</a>                     <a id="2343" class="Symbol">=</a> <a id="2345" href="Context.Base.html#437" class="InductiveConstructor">[]</a>
<a id="2348" href="IS4.Term.Base.html#2258" class="Function">rCtxₛ</a> <a id="2354" class="Symbol">(</a><a id="2355" href="Context.Base.html#4057" class="InductiveConstructor">ext</a> <a id="2359" href="IS4.Term.Base.html#2359" class="Bound">e</a><a id="2360" class="Symbol">)</a>   <a id="2364" class="Symbol">(</a><a id="2365" href="IS4.Term.Base.html#2365" class="Bound">s</a> <a id="2367" href="Context.Base.html#11195" class="InductiveConstructor Operator">`,</a> <a id="2370" href="IS4.Term.Base.html#2370" class="Bound">t</a><a id="2371" class="Symbol">)</a>              <a id="2386" class="Symbol">=</a> <a id="2388" href="IS4.Term.Base.html#2258" class="Function">rCtxₛ</a> <a id="2394" href="IS4.Term.Base.html#2359" class="Bound">e</a> <a id="2396" href="IS4.Term.Base.html#2365" class="Bound">s</a>
<a id="2398" href="IS4.Term.Base.html#2258" class="Function">rCtxₛ</a> <a id="2404" class="Symbol">(</a><a id="2405" href="Context.Base.html#4253" class="InductiveConstructor">ext#-</a> <a id="2411" href="IS4.Term.Base.html#2411" class="Bound">e</a><a id="2412" class="Symbol">)</a> <a id="2414" class="Symbol">(</a><a id="2415" href="Context.Base.html#11258" class="InductiveConstructor">lock</a> <a id="2420" class="Symbol">{</a><a id="2421" class="Argument">ΔR</a> <a id="2424" class="Symbol">=</a> <a id="2426" href="IS4.Term.Base.html#2426" class="Bound">ΔR</a><a id="2428" class="Symbol">}</a> <a id="2430" href="IS4.Term.Base.html#2430" class="Bound">s</a> <a id="2432" href="IS4.Term.Base.html#2432" class="Bound">e&#39;</a><a id="2434" class="Symbol">)</a> <a id="2436" class="Symbol">=</a> <a id="2438" href="IS4.Term.Base.html#2258" class="Function">rCtxₛ</a> <a id="2444" href="IS4.Term.Base.html#2411" class="Bound">e</a> <a id="2446" href="IS4.Term.Base.html#2430" class="Bound">s</a> <a id="2448" href="Context.Base.html#849" class="Function Operator">,,</a> <a id="2451" href="IS4.Term.Base.html#2426" class="Bound">ΔR</a>

<a id="factorExtₛ"></a><a id="2455" href="IS4.Term.Base.html#2455" class="Function">factorExtₛ</a> <a id="2466" class="Symbol">:</a> <a id="2468" class="Symbol">(</a><a id="2469" href="IS4.Term.Base.html#2469" class="Bound">e</a> <a id="2471" class="Symbol">:</a> <a id="2473" href="Context.Base.html#5052" class="Function">CExt</a> <a id="2478" href="Context.Base.html#598" class="Generalizable">Γ</a> <a id="2480" href="Context.Base.html#607" class="Generalizable">ΓL</a> <a id="2483" href="Context.Base.html#627" class="Generalizable">ΓR</a><a id="2485" class="Symbol">)</a> <a id="2487" class="Symbol">(</a><a id="2488" href="IS4.Term.Base.html#2488" class="Bound">s</a> <a id="2490" class="Symbol">:</a> <a id="2492" href="Context.Base.html#11143" class="Datatype">Sub</a> <a id="2496" href="Context.Base.html#655" class="Generalizable">Δ</a> <a id="2498" href="Context.Base.html#598" class="Generalizable">Γ</a><a id="2499" class="Symbol">)</a> <a id="2501" class="Symbol">→</a> <a id="2503" href="Context.Base.html#5052" class="Function">CExt</a> <a id="2508" href="Context.Base.html#655" class="Generalizable">Δ</a> <a id="2510" class="Symbol">(</a><a id="2511" href="IS4.Term.Base.html#1800" class="Function">lCtxₛ</a> <a id="2517" href="IS4.Term.Base.html#2469" class="Bound">e</a> <a id="2519" href="IS4.Term.Base.html#2488" class="Bound">s</a><a id="2520" class="Symbol">)</a> <a id="2522" class="Symbol">(</a><a id="2523" href="IS4.Term.Base.html#2258" class="Function">rCtxₛ</a> <a id="2529" href="IS4.Term.Base.html#2469" class="Bound">e</a> <a id="2531" href="IS4.Term.Base.html#2488" class="Bound">s</a><a id="2532" class="Symbol">)</a>
<a id="2534" href="IS4.Term.Base.html#2455" class="Function">factorExtₛ</a> <a id="2545" href="Context.Base.html#4035" class="InductiveConstructor">nil</a>       <a id="2555" href="IS4.Term.Base.html#2555" class="Bound">s</a>           <a id="2567" class="Symbol">=</a> <a id="2569" href="Context.Base.html#4035" class="InductiveConstructor">nil</a>
<a id="2573" href="IS4.Term.Base.html#2455" class="Function">factorExtₛ</a> <a id="2584" class="Symbol">(</a><a id="2585" href="Context.Base.html#4057" class="InductiveConstructor">ext</a> <a id="2589" href="IS4.Term.Base.html#2589" class="Bound">e</a><a id="2590" class="Symbol">)</a>   <a id="2594" class="Symbol">(</a><a id="2595" href="IS4.Term.Base.html#2595" class="Bound">s</a> <a id="2597" href="Context.Base.html#11195" class="InductiveConstructor Operator">`,</a> <a id="2600" class="Symbol">_)</a>    <a id="2606" class="Symbol">=</a> <a id="2608" href="IS4.Term.Base.html#2455" class="Function">factorExtₛ</a> <a id="2619" href="IS4.Term.Base.html#2589" class="Bound">e</a> <a id="2621" href="IS4.Term.Base.html#2595" class="Bound">s</a>
<a id="2623" href="IS4.Term.Base.html#2455" class="Function">factorExtₛ</a> <a id="2634" class="Symbol">(</a><a id="2635" href="Context.Base.html#4253" class="InductiveConstructor">ext#-</a> <a id="2641" href="IS4.Term.Base.html#2641" class="Bound">e</a><a id="2642" class="Symbol">)</a> <a id="2644" class="Symbol">(</a><a id="2645" href="Context.Base.html#11258" class="InductiveConstructor">lock</a> <a id="2650" href="IS4.Term.Base.html#2650" class="Bound">s</a> <a id="2652" href="IS4.Term.Base.html#2652" class="Bound">e&#39;</a><a id="2654" class="Symbol">)</a> <a id="2656" class="Symbol">=</a> <a id="2658" href="Context.Base.html#6133" class="Function">extRAssoc</a> <a id="2668" class="Symbol">(</a><a id="2669" href="IS4.Term.Base.html#2455" class="Function">factorExtₛ</a> <a id="2680" href="IS4.Term.Base.html#2641" class="Bound">e</a> <a id="2682" href="IS4.Term.Base.html#2650" class="Bound">s</a><a id="2683" class="Symbol">)</a> <a id="2685" href="IS4.Term.Base.html#2652" class="Bound">e&#39;</a>

<a id="2689" class="Comment">-- apply substitution to a term</a>
<a id="substTm"></a><a id="2721" href="IS4.Term.Base.html#2721" class="Function">substTm</a> <a id="2729" class="Symbol">:</a> <a id="2731" href="Context.Base.html#11143" class="Datatype">Sub</a> <a id="2735" href="Context.Base.html#655" class="Generalizable">Δ</a> <a id="2737" href="Context.Base.html#598" class="Generalizable">Γ</a> <a id="2739" class="Symbol">→</a> <a id="2741" href="IS4.Term.Base.html#609" class="Datatype">Tm</a> <a id="2744" href="Context.Base.html#598" class="Generalizable">Γ</a> <a id="2746" href="Type.Base.html#172" class="Generalizable">a</a> <a id="2748" class="Symbol">→</a> <a id="2750" href="IS4.Term.Base.html#609" class="Datatype">Tm</a> <a id="2753" href="Context.Base.html#655" class="Generalizable">Δ</a> <a id="2755" href="Type.Base.html#172" class="Generalizable">a</a>
<a id="2757" href="IS4.Term.Base.html#2721" class="Function">substTm</a> <a id="2765" href="IS4.Term.Base.html#2765" class="Bound">s</a> <a id="2767" class="Symbol">(</a><a id="2768" href="IS4.Term.Base.html#638" class="InductiveConstructor">var</a> <a id="2772" href="IS4.Term.Base.html#2772" class="Bound">x</a><a id="2773" class="Symbol">)</a>     <a id="2779" class="Symbol">=</a> <a id="2781" href="Context.Base.html#11771" class="Function">substVar</a> <a id="2790" href="IS4.Term.Base.html#2765" class="Bound">s</a> <a id="2792" href="IS4.Term.Base.html#2772" class="Bound">x</a>
<a id="2794" href="IS4.Term.Base.html#2721" class="Function">substTm</a> <a id="2802" href="IS4.Term.Base.html#2802" class="Bound">s</a> <a id="2804" class="Symbol">(</a><a id="2805" href="IS4.Term.Base.html#701" class="InductiveConstructor">lam</a> <a id="2809" href="IS4.Term.Base.html#2809" class="Bound">t</a><a id="2810" class="Symbol">)</a>     <a id="2816" class="Symbol">=</a> <a id="2818" href="IS4.Term.Base.html#701" class="InductiveConstructor">lam</a> <a id="2822" class="Symbol">(</a><a id="2823" href="IS4.Term.Base.html#2721" class="Function">substTm</a> <a id="2831" class="Symbol">(</a><a id="2832" href="Context.Base.html#12314" class="Function">keepₛ</a> <a id="2838" href="IS4.Term.Base.html#2802" class="Bound">s</a><a id="2839" class="Symbol">)</a> <a id="2841" href="IS4.Term.Base.html#2809" class="Bound">t</a><a id="2842" class="Symbol">)</a>
<a id="2844" href="IS4.Term.Base.html#2721" class="Function">substTm</a> <a id="2852" href="IS4.Term.Base.html#2852" class="Bound">s</a> <a id="2854" class="Symbol">(</a><a id="2855" href="IS4.Term.Base.html#782" class="InductiveConstructor">app</a> <a id="2859" href="IS4.Term.Base.html#2859" class="Bound">t</a> <a id="2861" href="IS4.Term.Base.html#2861" class="Bound">u</a><a id="2862" class="Symbol">)</a>   <a id="2866" class="Symbol">=</a> <a id="2868" href="IS4.Term.Base.html#782" class="InductiveConstructor">app</a> <a id="2872" class="Symbol">(</a><a id="2873" href="IS4.Term.Base.html#2721" class="Function">substTm</a> <a id="2881" href="IS4.Term.Base.html#2852" class="Bound">s</a> <a id="2883" href="IS4.Term.Base.html#2859" class="Bound">t</a><a id="2884" class="Symbol">)</a> <a id="2886" class="Symbol">(</a><a id="2887" href="IS4.Term.Base.html#2721" class="Function">substTm</a> <a id="2895" href="IS4.Term.Base.html#2852" class="Bound">s</a> <a id="2897" href="IS4.Term.Base.html#2861" class="Bound">u</a><a id="2898" class="Symbol">)</a>
<a id="2900" href="IS4.Term.Base.html#2721" class="Function">substTm</a> <a id="2908" href="IS4.Term.Base.html#2908" class="Bound">s</a> <a id="2910" class="Symbol">(</a><a id="2911" href="IS4.Term.Base.html#877" class="InductiveConstructor">box</a> <a id="2915" href="IS4.Term.Base.html#2915" class="Bound">t</a><a id="2916" class="Symbol">)</a>     <a id="2922" class="Symbol">=</a> <a id="2924" href="IS4.Term.Base.html#877" class="InductiveConstructor">box</a> <a id="2928" class="Symbol">(</a><a id="2929" href="IS4.Term.Base.html#2721" class="Function">substTm</a> <a id="2937" class="Symbol">(</a><a id="2938" href="Context.Base.html#12425" class="Function">keep#ₛ</a> <a id="2945" href="IS4.Term.Base.html#2908" class="Bound">s</a><a id="2946" class="Symbol">)</a> <a id="2948" href="IS4.Term.Base.html#2915" class="Bound">t</a><a id="2949" class="Symbol">)</a>
<a id="2951" href="IS4.Term.Base.html#2721" class="Function">substTm</a> <a id="2959" href="IS4.Term.Base.html#2959" class="Bound">s</a> <a id="2961" class="Symbol">(</a><a id="2962" href="IS4.Term.Base.html#953" class="InductiveConstructor">unbox</a> <a id="2968" href="IS4.Term.Base.html#2968" class="Bound">t</a> <a id="2970" href="IS4.Term.Base.html#2970" class="Bound">e</a><a id="2971" class="Symbol">)</a> <a id="2973" class="Symbol">=</a> <a id="2975" href="IS4.Term.Base.html#953" class="InductiveConstructor">unbox</a> <a id="2981" class="Symbol">(</a><a id="2982" href="IS4.Term.Base.html#2721" class="Function">substTm</a> <a id="2990" class="Symbol">(</a><a id="2991" href="IS4.Term.Base.html#1984" class="Function">factorSubₛ</a> <a id="3002" href="IS4.Term.Base.html#2970" class="Bound">e</a> <a id="3004" href="IS4.Term.Base.html#2959" class="Bound">s</a><a id="3005" class="Symbol">)</a> <a id="3007" href="IS4.Term.Base.html#2968" class="Bound">t</a><a id="3008" class="Symbol">)</a> <a id="3010" class="Symbol">(</a><a id="3011" href="IS4.Term.Base.html#2455" class="Function">factorExtₛ</a> <a id="3022" href="IS4.Term.Base.html#2970" class="Bound">e</a> <a id="3024" href="IS4.Term.Base.html#2959" class="Bound">s</a><a id="3025" class="Symbol">)</a>

<a id="3028" class="Keyword">open</a> <a id="3033" href="IS4.Term.Base.html#1691" class="Module">SubstitutionComposition</a> <a id="3057" href="IS4.Term.Base.html#2721" class="Function">substTm</a> <a id="3065" href="IS4.Term.Base.html#1800" class="Function">lCtxₛ</a> <a id="3071" href="IS4.Term.Base.html#1984" class="Function">factorSubₛ</a> <a id="3082" href="IS4.Term.Base.html#2258" class="Function">rCtxₛ</a> <a id="3088" href="IS4.Term.Base.html#2455" class="Function">factorExtₛ</a> <a id="3099" class="Keyword">public</a>
</pre></body></html>